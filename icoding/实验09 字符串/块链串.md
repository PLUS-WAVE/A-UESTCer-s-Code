## é¢˜ç›®ï¼š

å—é“¾ä¸²å®šä¹‰å¦‚ä¸‹ï¼š

```cpp
#define BLOCK_SIZE 4    // å¯ç”±ç”¨æˆ·å®šä¹‰çš„å—å¤§å°
#define BLS_BLANK '#'   // ç”¨äºç©ºç™½å¤„çš„è¡¥é½å­—ç¬¦

typedef struct _block {
    char ch[BLOCK_SIZE];    //å—çš„æ•°æ®åŸŸ
    struct _block *next;    //å—çš„æŒ‡é’ˆåŸŸ
} Block;

typedef struct {
    Block *head;        // ä¸²çš„å¤´æŒ‡é’ˆ
    Block *tail;        // ä¸²çš„å°¾æŒ‡é’ˆ
    int len;            // ä¸²çš„å½“å‰é•¿åº¦
} BLString;

//å­—ç¬¦ä¸²åˆå§‹åŒ–å‡½æ•°ï¼š
void blstr_init(BLString *T) {
    T->len = 0;
    T->head = NULL;
    T->tail = NULL;
}
```

è¿™äº›å®šä¹‰å·²åŒ…å«åœ¨å¤´æ–‡ä»¶ dsstring.h ä¸­ï¼Œè¯·å®ç°å—é“¾ä¸²çš„å­ä¸²æŸ¥æ‰¾æ“ä½œï¼š

```cpp
bool blstr_substr(BLString src, int pos, int len, BLString *sub);
```

srcä¸ºè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²  
posä¸ºå­ä¸²å¼€å§‹çš„ä¸‹æ ‡  
lenä¸ºå­ä¸²çš„é•¿åº¦  
subåœ¨å‡½æ•°è°ƒç”¨è¿è¡Œå‰æŒ‡å‘ä¸€ä¸ªå·²ç»åˆå§‹åŒ–å¥½çš„ç©ºä¸²ï¼Œåœ¨å‡½æ•°è¿”å›æ—¶ï¼ŒsubæŒ‡å‘ä¸²srcä»ç¬¬posä¸ªå­—ç¬¦èµ·é•¿åº¦ä¸ºlençš„å­ä¸²  
å‡½æ•°æŸ¥æ‰¾æˆåŠŸè¿”å›trueï¼Œå‚æ•°ä¸æ­£ç¡®è¿”å› false

> PSï¼šæœ¬é¢˜æè¿°åŠå…¶æ¨¡ç³Šï¼Œå¾ˆå¤šç»†èŠ‚å¹¶æœªæåŠğŸ”ªğŸ”ªğŸ”ª
> 
> è¯¦æƒ…è¯·è§å¤§ä½¬[æ³¥ç”µicoding å—é“¾ä¸²_Focnalçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/Caliber_/article/details/123969074)

## ä»£ç ï¼š

```cpp
#include <stdlib.h>
#include <stdio.h>
#include"dsstring.h" // è¯·ä¸è¦åˆ é™¤ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡

bool blstr_substr(BLString src, int start_pos, int len, BLString* sub) {
    // æ£€æŸ¥å‚æ•°åˆæ³•æ€§
    if (start_pos < 0 || start_pos >= src.len || len < 1 || sub == NULL) {
        return false;
    }

    // åˆå§‹åŒ–å­å­—ç¬¦ä¸²çš„å¤´æŒ‡é’ˆå’Œæºå­—ç¬¦ä¸²çš„æŒ‡é’ˆ
    sub->head = (Block*)malloc(sizeof(Block));
    if (sub->head == NULL) {
        return false;
    }
    Block* curr_block = sub->head, * src_block = src.head;

    // åˆå§‹åŒ–è®¡æ•°å™¨
    //src_posæŒ‡ç¤ºåœ¨åŸå­—ç¬¦ä¸²ä¸­è¦æå–å­å­—ç¬¦ä¸²çš„ä½ç½®
    //sub_posæŒ‡ç¤ºåœ¨å­å­—ç¬¦ä¸²ä¸­è¦å¤åˆ¶å­—ç¬¦çš„ä½ç½®
    //char_countæŒ‡ç¤ºå·²ç»éå†è¿‡çš„å­—ç¬¦æ•°
    int src_pos = 0, sub_pos = 0, char_count = 0;

    // åˆå§‹åŒ–å°¾æŒ‡é’ˆå’Œé•¿åº¦
    curr_block->next = NULL;
    sub->tail = curr_block;
    sub->len = 0;

    // å¾ªç¯éå†æºå­—ç¬¦ä¸²å’Œå­å­—ç¬¦ä¸²
    while (char_count <= start_pos + len - 1 && src_block != NULL && src_block->ch[src_pos] != BLS_BLANK) {
        if (char_count < start_pos) { // è·³è¿‡å‰ start_pos ä¸ªå­—ç¬¦ï¼Œåˆ° start_pos çš„ä½ç½®
            if (src_pos < BLOCK_SIZE - 1) { // å¦‚æœå½“å‰å—æœªæ»¡ï¼Œç»§ç»­è¯»å–è¯¥å—çš„ä¸‹ä¸€ä¸ªå­—ç¬¦
                src_pos++;
            }
            else { // å¦åˆ™ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå—
                src_block = src_block->next;
                src_pos = 0;
            }
            char_count++;
        }
        else { // å¤åˆ¶å­å­—ç¬¦ä¸²åˆ° sub ä¸­
            curr_block->ch[sub_pos] = src_block->ch[src_pos]; // å¤åˆ¶å½“å‰å­—ç¬¦
            if (src_pos < BLOCK_SIZE - 1) { // åŸå­—ç¬¦ä¸²å—ï¼šå¦‚æœå½“å‰å—æœªæ»¡ï¼Œç»§ç»­è¯»å–è¯¥å—çš„ä¸‹ä¸€ä¸ªå­—ç¬¦
                src_pos++;
            }
            else { // å¦åˆ™ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå—
                src_block = src_block->next;
                src_pos = 0;
            }

            if (sub_pos < BLOCK_SIZE - 1) { // å­å­—ç¬¦ä¸²å—ï¼šå¦‚æœå½“å‰å—æœªæ»¡ï¼Œç»§ç»­å¤åˆ¶åˆ°å½“å‰å—
                sub_pos++;
            }
            else { // å¦åˆ™ï¼Œåˆ†é…æ–°å—
                curr_block->next = (Block*)malloc(sizeof(Block));
                curr_block = curr_block->next;
                curr_block->next = NULL;
                sub_pos = 0;
            }
            char_count++;
            sub->len++;
        }
    }

    // å¤„ç†å°¾æŒ‡é’ˆå’Œå¤šä½™çš„ç©ºé—´
    if (sub_pos != 0) { // å¦‚æœæœ€åä¸€ä¸ªå—æœªæ»¡ï¼Œç”¨ç©ºæ ¼å¡«å……
        sub->tail = curr_block;
        while (sub_pos < BLOCK_SIZE) {
            curr_block->ch[sub_pos++] = BLS_BLANK;
        }
    }
    else { // å¦‚æœæœ€åä¸€ä¸ªå—æ˜¯ç©ºçš„ï¼Œåˆ é™¤è¯¥å—

        // éå†æ‰¾åˆ°æœ€åä¸€ä¸ªå—çš„å‰ä¸€ä¸ªå—
        sub->tail = sub->head;
        while (sub->tail->next != curr_block) {
            sub->tail = sub->tail->next;
            if (sub->tail == NULL) { // ä»…ä»…ä¸ºäº†æ¶ˆé™¤VSçš„è­¦å‘Šâ€œsub->tailä¸ºNULLï¼Œå–æ¶ˆå¯¹ç©ºæŒ‡é’ˆçš„å¼•ç”¨â€
                return false;
            }
        }
        sub->tail->next = NULL;
        free(curr_block);
    }

    return true;
}
```

æœ¬é¢˜å€Ÿé‰´äº†ï¼š

ä½œè€…: Cosmos_F
é“¾æ¥: https://cosmos-uestc.space/post/716e4956.html#T1
åœ¨å¤§ä½¬çš„å¯å‘ä¸‹ï¼Œè¿›è¡Œäº†ä¸€ç‚¹ä¿®æ”¹ï¼Œæ€è·¯æ˜¯å¤§ä½¬çš„ğŸ˜­ğŸ˜­ğŸ˜­

***å¥½å¥½å¥½æ¶å¿ƒï¼ï¼ï¼ï¼***
